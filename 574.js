"use strict";(self.webpackChunkonsenui_v2_react_minimum=self.webpackChunkonsenui_v2_react_minimum||[]).push([[574],{8461:(t,a,e)=>{function r(t,a){"accDescr"in t&&t.accDescr&&a.setAccDescription?.(t.accDescr),"accTitle"in t&&t.accTitle&&a.setAccTitle?.(t.accTitle),"title"in t&&t.title&&a.setDiagramTitle?.(t.title)}e.d(a,{S:()=>r}),(0,e(9610).K2)(r,"populateCommonDb")},574:(t,a,e)=>{e.d(a,{diagram:()=>Z});var r,n=e(8461),o=e(4208),l=e(1243),i=e(4584),s=e(9838),d=e(9610),c=[],p=[...c],m=s.UI.visual,h=(0,d.K2)((()=>(0,i.$t)({...m,...(0,s.zj)().visual})),"getConfig"),x=(0,d.K2)((()=>p),"getPages"),g=(0,d.K2)((t=>{p.push(t)}),"addPage"),f=(0,d.K2)((()=>r),"getSize"),b=(0,d.K2)((t=>{r=t}),"setSize"),w={getPages:x,addPage:g,getConfig:h,clear:(0,d.K2)((()=>{(0,s.IU)(),p=[...c],r=void 0}),"clear"),setAccTitle:s.SV,getAccTitle:s.iN,setDiagramTitle:s.ke,getDiagramTitle:s.ab,getAccDescription:s.m7,setAccDescription:s.EI,getSize:f,setSize:b},u=(0,d.K2)((t=>{(0,n.S)(t,w),t.size&&w.setSize&&w.setSize({width:t.size.width,height:t.size.height});const a=(0,d.K2)(((t,a)=>{if(t){if("column"in t&&"row"in t){const a=t.column,e=t.row,r=a&&"start"in a&&"end"in a,n=e&&"start"in e&&"end"in e;return r||n?{column:r?{start:a.start,end:a.end}:a.single??a,row:n?{start:e.start,end:e.end}:e.single??e}:{column:a.single??a,row:e.single??e}}return{type:"previous",placement:a||"below"}}}),"processPosition");for(const e of t.pages){const t=e.subDiagrams.map((t=>{switch(t.diagramType){case"array":return{type:"array",orientation:t.orientation,title:t.diagramTitle,position:a(t.position),showIndex:t.showIndex,label:t.label,elements:t.elements.map((t=>({value:t.value,color:t.color,arrow:void 0!==t.arrowLabel&&null!==t.arrowLabel,arrowLabel:t.arrowLabel})))};case"matrix":return{type:"matrix",title:t.diagramTitle,position:a(t.position),rows:t.rows.map((t=>({elements:t.elements.map((t=>({value:t.value,color:t.color,arrow:void 0!==t.arrowLabel&&null!==t.arrowLabel,arrowLabel:t.arrowLabel})))}))),showIndex:t.showIndex,label:t.label};case"stack":return{type:"stack",orientation:t.orientation,title:t.diagramTitle,position:a(t.position),showIndex:t.showIndex,label:t.label,size:t.size,elements:t.elements.map((t=>({value:t.value,color:t.color,arrow:void 0!==t.arrowLabel&&null!==t.arrowLabel,arrowLabel:t.arrowLabel})))};case"tree":return{type:"tree",title:t.diagramTitle,position:a(t.position),label:t.label,elements:t.elements.map((t=>({nodeId:t.nodeId,left:"None"==t.left?void 0:t.left,right:"None"==t.right?void 0:t.right,value:t.value,color:t.color,arrow:void 0!==t.arrowLabel&&null!==t.arrowLabel,arrowLabel:t.arrowLabel})))};case"graph":return{type:"graph",title:t.diagramTitle,position:a(t.position),label:t.label,elements:t.elements.map((t=>{if("NodeDefinition"==t.$type)return{type:"node",nodeId:t.nodeId,value:t.value,color:t.color,arrow:void 0!==t.arrowLabel&&null!==t.arrowLabel,arrowLabel:t.arrowLabel,hidden:"true"==(t.hidden||"").toLowerCase()};if("EdgeDefinition"==t.$type)return{type:"edge",start:t.start,end:t.end,value:t.value,color:t.color};throw new Error("Unknown graph element type")}))};case"linkedList":return{type:"linkedList",title:t.diagramTitle,position:a(t.position),label:t.label,elements:t.elements.map((t=>({value:t.value,color:t.color,arrow:!!t.arrowLabel,arrowLabel:t.arrowLabel})))};case"text":return{type:"text",title:t.diagramTitle,position:a(t.position,t.placement),fontSize:t.fontSize,color:t.color,fontWeight:t.fontWeight,fontFamily:t.fontFamily,align:t.align,lineSpacing:t.lineSpacing,width:t.width,height:t.height,label:t.label,elements:t.elements.map((t=>{if(t.attributes&&t.attributes.length>0){const a={value:t.value};return t.attributes.forEach((t=>{a[t.name]=t.value})),a}return t.value}))};default:throw new Error(`Unknown diagram type: ${t.diagramType}`)}}));w.addPage({layout:e.layout?{columns:e.layout.columns,rows:e.layout.rows}:void 0,subDiagrams:t})}}),"populate"),y={parse:async t=>{const a=await(0,o.q)("visual",t);s.Rm.debug(a),u(a)}},k=(0,d.K2)(((t,a=.6)=>{if(F(t))return t||"null";const e={black:"#000000",white:"#FFFFFF",red:"#FF0000",green:"#008000",blue:"#0000FF",yellow:"#FFFF00",cyan:"#00FFFF",magenta:"#FF00FF",gray:"#808080",grey:"#808080",maroon:"#800000",olive:"#808000",purple:"#800080",teal:"#008080",navy:"#000080",orange:"#FFA500",pink:"#FFC0CB",brown:"#A52A2A",aqua:"#00FFFF",lime:"#00FF00",gold:"#FFD700",silver:"#C0C0C0",beige:"#F5F5DC",coral:"#FF7F50",chocolate:"#D2691E",crimson:"#DC143C",indigo:"#4B0082",khaki:"#F0E68C",lavender:"#E6E6FA",orchid:"#DA70D6",plum:"#DDA0DD",salmon:"#FA8072",sienna:"#A0522D",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",azure:"#F0FFFF",ivory:"#FFFFF0",mintcream:"#F5FFFA",snow:"#FFFAFA",goldenrod:"#DAA520",tomato:"#FF6347",slateblue:"#6A5ACD",darkgreen:"#006400",darkblue:"#00008B",darkred:"#8B0000",darkorange:"#FF8C00",darkviolet:"#9400D3",darkkhaki:"#BDB76B",lightblue:"#ADD8E6",lightgreen:"#90EE90",lightcoral:"#F08080",lightgray:"#D3D3D3",lightgrey:"#D3D3D3"},r=t?t.toLowerCase():"";return r in e?L(e[r],a):"white"}),"getColor");function F(t){return!!t&&/^#([\dA-Fa-f]{3}){1,2}$/.test(t)}(0,d.K2)(F,"isValidHexColor");var L=(0,d.K2)(((t,a)=>(t=t.replace(/^#/,""),`rgba(${parseInt(t.slice(0,2),16)}, ${parseInt(t.slice(2,4),16)}, ${parseInt(t.slice(4,6),16)}, ${a})`)),"hexToRgba"),v=(0,d.K2)((t=>{let a=t.toString();return a.startsWith('"')&&a.endsWith('"')&&(a=a.slice(1,-1)),"null"===a?"":"\\null"===a?"null":a}),"formatValue"),E=(0,d.K2)((t=>{if(!t)return!1;let a=t.toString();return a.startsWith('"')&&a.endsWith('"')&&(a=a.slice(1,-1)),"null"!==a}),"shouldDisplayArrowLabel"),z=(0,d.K2)(((t,a,e,r)=>{t.append("defs").append("marker").attr("id","arrowhead").attr("viewBox","0 0 10 10").attr("refX","5").attr("refY","5").attr("markerWidth","6").attr("markerHeight","6").attr("orient","auto-start-reverse").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("fill","black"),a.title&&t.append("text").attr("x",100).attr("y",20).attr("fill",e.labelColor).attr("font-size","16").attr("dominant-baseline","hanging").attr("text-anchor","middle").attr("class","arrayDiagramTitle").text(a.title);const n=t.append("g").attr("class","component").attr("id",`component_${r}`).attr("transform","translate(50, 40)");let o=0;if(a.elements.forEach(((t,r)=>{D(n,t,r,e,a.showIndex||!1,o),o+=1})),a.label){const t=160,r=100;n.append("text").attr("x",r).attr("y",t).attr("fill",e.labelColor).attr("font-size","16").attr("dominant-baseline","hanging").attr("text-anchor","middle").attr("class","arrayDiagramLabel").text(a.label)}}),"drawArrayDiagram"),D=(0,d.K2)(((t,a,e,{labelColor:r,labelFontSize:n},o,l)=>{const i=t.append("g");i.attr("class","unit").attr("id",`unit_${l}`);const s=40*e,d=k(a.color);if(a.arrow&&E(a.arrowLabel)){const t=10,e=40;i.append("line").attr("x1",s+20).attr("y1",t).attr("x2",s+20).attr("y2",e).attr("stroke","black").attr("stroke-width","1.5").attr("marker-end","url(#arrowhead)"),E(a.arrowLabel)&&i.append("text").attr("x",s+20).attr("y",t-20).attr("fill",r).attr("font-size","16").attr("dominant-baseline","hanging").attr("text-anchor","middle").attr("class","arrowContext").text(v(a.arrowLabel||""))}i.append("rect").attr("x",s).attr("y",50).attr("width",40).attr("height",40).style("fill",d).attr("stroke","#000000").attr("stroke-width","2px").attr("class","arrayElement"),i.append("text").attr("x",s+20).attr("y",70).attr("fill",r).attr("font-size","16").attr("dominant-baseline","middle").attr("text-anchor","middle").attr("class","elementLabel").text(v(a.value)),o&&i.append("text").attr("x",s+20).attr("y",110).attr("fill",r).attr("font-size","16").attr("dominant-baseline","middle").attr("text-anchor","middle").attr("class","indexLabel").text(e)}),"drawElement"),$=(0,d.K2)(((t,a,e,r)=>{a.title;const n=t.append("g");n.attr("class","component").attr("id",`component_${r}`);const o=a.rows.length,l=Math.max(...a.rows.map((t=>t.elements.length)));if(a.title&&t.append("text").attr("x",50).attr("y",0).attr("fill",e.labelColor).attr("font-size",e.labelFontSize).attr("dominant-baseline","hanging").attr("text-anchor","start").attr("class","diagramTitle").text(a.title),a.rows.forEach(((t,a)=>{t.elements.forEach(((t,r)=>{K(n,t,a,r,e),S(n,a,r,e)}))})),a.label){const t=50*o+50,r=25*l;n.append("text").attr("x",r).attr("y",t).attr("fill",e.labelColor).attr("font-size",e.labelFontSize).attr("dominant-baseline","hanging").attr("text-anchor","middle").attr("class","arrayDiagramLabel").text(a.label)}a.showIndex&&I(n,o,l,e)}),"drawMatrixDiagram"),K=(0,d.K2)(((t,a,e,r,{labelColor:n,labelFontSize:o})=>{const l=t.append("g");l.attr("class","unit").attr("id",`unit_(${e},${r})`);const i=50*r,s=50*e,d=k(a.color);l.append("rect").attr("x",i).attr("y",s).attr("width",50).attr("height",50).style("fill",d).attr("stroke","#000000").attr("stroke-width","1.2px").attr("class","matrixElement");const c=v(a.value);l.append("text").attr("x",i+25).attr("y",s+25).attr("fill",n).attr("font-size",o).attr("dominant-baseline","middle").attr("text-anchor","middle").attr("class","elementLabel").text(c),a.arrow&&E(a.arrowLabel)&&(l.append("circle").attr("cx",i+25).attr("cy",s+25).attr("r",23).attr("stroke","red").attr("stroke-width","2").attr("fill","none"),l.append("text").attr("x",i+52).attr("y",s+25).attr("fill","red").attr("font-size",o).attr("dominant-baseline","middle").attr("text-anchor","start").attr("class","arrowLabel").text(v(a.arrowLabel||"")))}),"drawElement"),I=(0,d.K2)(((t,a,e,{labelColor:r,labelFontSize:n})=>{const o=t.append("g");for(let t=0;t<a;t++)o.append("text").attr("x",-10).attr("y",50*t+25).attr("fill",r).attr("font-size",n).attr("dominant-baseline","middle").attr("text-anchor","middle").attr("class","rowIndex").text(t.toString());for(let t=0;t<e;t++)o.append("text").attr("x",50*t+25).attr("y",-10).attr("fill",r).attr("font-size",n).attr("dominant-baseline","middle").attr("text-anchor","middle").attr("class","colIndex").text(t.toString())}),"addIndices"),S=(0,d.K2)(((t,a,e,{borderColor:r,borderWidth:n})=>{const o=50*e,l=50*a;t.append("g").append("rect").attr("x",o).attr("y",l).attr("width",50).attr("height",50).attr("stroke",r).attr("stroke-width",n).attr("fill","none")}),"drawGrid"),C=(0,d.K2)(((t,a,e)=>{t.append("defs").append("marker").attr("id","arrowhead").attr("viewBox","0 0 10 10").attr("refX","5").attr("refY","5").attr("markerWidth","6").attr("markerHeight","6").attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("fill","black");const r=t.append("g");r.attr("class","component").attr("id",`component_${e}`);const n=40*a.size;T(r,50,0,70,n);let o=0;if(a.elements.forEach(((t,e)=>{const n=a.size-a.elements.length+e;A(r,t,n,o),o+=1})),a.label){const t=n+40+20,e=85;r.append("text").attr("x",e).attr("y",t).attr("fill","black").attr("font-size","16").attr("dominant-baseline","hanging").attr("text-anchor","middle").attr("class","stackDiagramLabel").text(a.label)}}),"drawStackDiagram"),A=(0,d.K2)(((t,a,e,r)=>{const n=t.append("g");n.attr("class","unit").attr("id",`unit_${r}`);const o=40*e,l=k(a.color);if(n.append("rect").attr("x",50).attr("y",o).attr("width",70).attr("height",40).style("fill",l).attr("stroke","black").attr("stroke-width","1").attr("class","stackElement"),a.arrow&&E(a.arrowLabel)){const t=130,e=t+40;n.append("line").attr("x1",e).attr("y1",o+20).attr("x2",t).attr("y2",o+20).attr("stroke","black").attr("stroke-width","1.5").attr("marker-end","url(#arrowhead)"),E(a.arrowLabel)&&n.append("text").attr("x",e+10).attr("y",o+20).attr("fill","black").attr("font-size","16").attr("dominant-baseline","middle").attr("text-anchor","start").attr("class","arrowContext").text(v(a.arrowLabel||""))}n.append("text").attr("x",85).attr("y",o+20).attr("fill","black").attr("font-size","16").attr("dominant-baseline","middle").attr("text-anchor","middle").attr("class","elementLabel").text(v(a.value))}),"drawElement"),T=(0,d.K2)(((t,a,e,r,n)=>{const o="#000000";t.append("line").attr("x1",a).attr("y1",e).attr("x2",a).attr("y2",e+n).attr("stroke",o).attr("stroke-width",2),t.append("line").attr("x1",a+r).attr("y1",e).attr("x2",a+r).attr("y2",e+n).attr("stroke",o).attr("stroke-width",2),t.append("line").attr("x1",a).attr("y1",e+n).attr("x2",a+r).attr("y2",e+n).attr("stroke",o).attr("stroke-width",2)}),"drawFramework"),M=(0,d.K2)(((t,a,e)=>{const r=t.append("g");r.attr("class","component").attr("id",`component_${e}`),r.append("defs").append("marker").attr("id","arrowhead").attr("viewBox","0 0 10 10").attr("refX","5").attr("refY","5").attr("markerWidth","4").attr("markerHeight","5").attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("fill","black");const n=a.elements.filter((t=>"node"==t.type)),o=new Set(n.filter((t=>t.hidden)).map((t=>t.nodeId))),l=n.filter((t=>!t.hidden)),i=a.elements.filter((t=>"edge"==t.type&&!o.has(t.start)&&!o.has(t.end))),s=_(n||[]);if(i&&i.forEach((t=>{W(r,t,s)})),l){let t=0;l.forEach((a=>{B(r,a,s[a.nodeId],t),t+=1}))}if(a.label){const t=l?100*Math.ceil(l.length/3)+70:100,e=150;r.append("text").attr("x",e).attr("y",t).attr("fill","black").attr("font-size","16").attr("dominant-baseline","hanging").attr("text-anchor","middle").attr("class","graphDiagramLabel").text(a.label)}}),"drawGraphDiagram"),_=(0,d.K2)((t=>{const a={},e=2*Math.PI/t.length;return t.forEach(((t,r)=>{const n=r*e;a[t.nodeId]={x:150+100*Math.cos(n),y:150+100*Math.sin(n)}})),a}),"calculateNodePositions"),B=(0,d.K2)(((t,a,e,r)=>{if(a.hidden)return;const n=e.x,o=e.y,l=k(a.color),i=t.append("g");if(i.attr("class","unit").attr("id",`unit_${r}`),i.append("circle").attr("cx",n).attr("cy",o).attr("r",20).style("fill",l).attr("stroke","black").attr("stroke-width","1").attr("class","graphNode"),i.append("text").attr("x",n).attr("y",o).attr("dy",".35em").attr("fill","black").attr("font-size","16").attr("dominant-baseline","middle").attr("text-anchor","middle").attr("class","nodeLabel").text(v(a.value||a.nodeId)),a.arrow&&E(a.arrowLabel)){const t=n+45,e=n+25;i.append("line").attr("x1",t).attr("y1",o).attr("x2",e).attr("y2",o).attr("stroke","black").attr("stroke-width","2").attr("marker-end","url(#arrowhead)"),i.append("text").attr("x",t+5).attr("y",o).attr("fill","black").attr("font-size","14").attr("dominant-baseline","middle").attr("text-anchor","start").attr("class","arrowLabel").text(v(a.arrowLabel||""))}}),"drawNode"),W=(0,d.K2)(((t,a,e)=>{const r=e[a.start],n=e[a.end];if(r&&n){const{startX:e,startY:o,endX:l,endY:i}=P(r,n),s=a.color||"black";t.append("line").attr("x1",e||0).attr("y1",o||0).attr("x2",l||0).attr("y2",i||0).attr("stroke",s).attr("stroke-width","2"),a.value&&t.append("text").attr("x",(e+l)/2).attr("y",(o+i)/2).attr("fill","black").attr("font-size","16").attr("dominant-baseline","middle").attr("text-anchor","middle").attr("class","edgeLabel").text(v(a.value))}}),"drawEdge"),P=(0,d.K2)(((t,a)=>{const e=a.x-t.x,r=a.y-t.y,n=Math.sqrt(e*e+r*r),o=20*e/n,l=20*r/n;return{startX:t.x+o,startY:t.y+l,endX:a.x-o,endY:a.y-l}}),"calculateEdgePosition"),X=(0,d.K2)(((t,a,e)=>{const r=t.append("g");r.attr("class","component").attr("id",`component_${e}`),r.append("defs").append("marker").attr("id","arrowhead").attr("viewBox","0 0 10 10").attr("refX","5").attr("refY","5").attr("markerWidth","4").attr("markerHeight","5").attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("fill","black");const n=a.elements||[],o=H(n),l=Y(n);if(o&&o.forEach((t=>{q(r,t,l)})),n){let t=0;n.forEach((a=>{j(r,a,l[a.nodeId],t),t+=1}))}if(a.label){const t=n?100*Math.ceil(n.length/3)+70:100,e=150;r.append("text").attr("x",e).attr("y",t).attr("fill","black").attr("font-size","16").attr("dominant-baseline","hanging").attr("text-anchor","middle").attr("class","treeDiagramLabel").text(a.label)}}),"drawTreeDiagram"),Y=(0,d.K2)((t=>{const a={},e=N(t),r=e>2?100:70,n=(0,d.K2)(((o,l,i)=>{const s=r-i*(r/e),d=l,c=0+100*i;a[o.nodeId]={x:d,y:c};const p=t.find((t=>t.nodeId===o.left)),m=t.find((t=>t.nodeId===o.right));p&&n(p,d-s,i+1),m&&n(m,d+s,i+1)}),"calculatePosition"),o=t.find((t=>!t.parentId));return o&&n(o,150,0),a}),"calculateNodePositions"),N=(0,d.K2)((t=>{const a=(0,d.K2)(((e,r)=>{const n=t.find((t=>t.nodeId===e.left)),o=t.find((t=>t.nodeId===e.right)),l=n?a(n,r+1):r,i=o?a(o,r+1):r;return Math.max(l,i)}),"findDepth"),e=t.find((t=>!t.parentId));return e?a(e,0):0}),"calculateMaxDepth"),H=(0,d.K2)((t=>{const a=[];return t.forEach((t=>{t.left&&a.push({start:t.nodeId,end:t.left}),t.right&&a.push({start:t.nodeId,end:t.right})})),a}),"calculateTreeEdges"),j=(0,d.K2)(((t,a,e,r)=>{const n=e.x,o=e.y,l=k(a.color),i=t.append("g");if(i.attr("class","unit").attr("id",`unit_${r}`),i.append("circle").attr("cx",n).attr("cy",o).attr("r",20).style("fill",l).attr("stroke","black").attr("stroke-width","1").attr("class","treeNode"),i.append("text").attr("x",n).attr("y",o).attr("dy",".35em").attr("fill","black").attr("font-size","16").attr("dominant-baseline","middle").attr("text-anchor","middle").attr("class","nodeLabel").text(v(a.value||a.nodeId)),a.arrow&&E(a.arrowLabel)){const t=n+45,e=n+25;i.append("line").attr("x1",t).attr("y1",o).attr("x2",e).attr("y2",o).attr("stroke","black").attr("stroke-width","2").attr("marker-end","url(#arrowhead)"),i.append("text").attr("x",t+5).attr("y",o).attr("fill","black").attr("font-size","16").attr("dominant-baseline","middle").attr("text-anchor","start").attr("class","arrowLabel").text(v(a.arrowLabel||""))}}),"drawNode"),q=(0,d.K2)(((t,a,e)=>{const r=e[a.start],n=e[a.end];if(r&&n){const{startX:e,startY:o,endX:l,endY:i}=U(r,n),s=a.color||"black";t.append("line").attr("x1",e).attr("y1",o).attr("x2",l).attr("y2",i).attr("stroke",s).attr("stroke-width","2"),a.value&&t.append("text").attr("x",(e+l)/2).attr("y",(o+i)/2).attr("fill","black").attr("font-size","16").attr("dominant-baseline","middle").attr("text-anchor","middle").attr("class","edgeLabel").text(v(a.value))}}),"drawEdge"),U=(0,d.K2)(((t,a)=>{const e=a.x-t.x,r=a.y-t.y,n=Math.sqrt(e*e+r*r),o=20*e/n,l=20*r/n;return{startX:t.x+o,startY:t.y+l,endX:a.x-o,endY:a.y-l}}),"calculateEdgePosition"),R=(0,d.K2)(((t,a,e)=>{const r=t.append("g");r.attr("class","component").attr("id",`component_${e}`),r.append("defs").append("marker").attr("id","arrowhead_node").attr("viewBox","0 0 10 10").attr("refX","5").attr("refY","5").attr("markerWidth","5").attr("markerHeight","6").attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("fill","black"),r.append("defs").append("marker").attr("id","arrowhead").attr("viewBox","0 0 10 10").attr("refX","5").attr("refY","5").attr("markerWidth","3").attr("markerHeight","5").attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("fill","black");const n=a.elements,o=G(n||[]);let l=0;if(n&&n.forEach(((t,a)=>{V(r,t,o[a],a<n.length-1,l),l+=1})),a.label){const t=100,e=150;r.append("text").attr("x",e).attr("y",t).attr("fill","black").attr("font-size","18").attr("dominant-baseline","hanging").attr("text-anchor","middle").attr("class","linkedListDiagramLabel").text(a.label)}}),"drawLinkedListDiagram"),G=(0,d.K2)((t=>{const a=[];return t.forEach(((t,e)=>{a.push({x:50+120*e,y:50})})),a}),"calculateNodePositions"),V=(0,d.K2)(((t,a,e,r,n)=>{const o=e.x,l=e.y,i=k(a.color),s=t.append("g");if(s.attr("class","unit").attr("id",`unit_${n}`),s.append("rect").attr("x",o).attr("y",l).attr("width",60).attr("height",30).style("fill",i).attr("stroke","black").attr("stroke-width","1").attr("class","linkedListNode"),s.append("text").attr("x",o+30).attr("y",l+15).attr("dy",".35em").attr("fill","black").attr("font-size","18").attr("dominant-baseline","middle").attr("text-anchor","middle").attr("class","nodeLabel").text(v(a.value)),E(a.arrowLabel)){const t=l-30,e=l-10;s.append("line").attr("x1",o+30).attr("y1",t).attr("x2",o+30).attr("y2",e).attr("stroke","black").attr("stroke-width","2").attr("marker-end","url(#arrowhead)"),s.append("text").attr("x",o+30).attr("y",t-10).attr("fill","black").attr("font-size","16").attr("dominant-baseline","middle").attr("text-anchor","middle").attr("class","arrowLabel").text(v(a.arrowLabel||""))}r&&s.append("line").attr("x1",o+60).attr("y1",l+15).attr("x2",o+60+55).attr("y2",l+15).attr("stroke","black").attr("stroke-width","2").attr("marker-end","url(#arrowhead_node)")}),"drawNode"),J=(0,d.K2)(((t,a,e)=>{const r=t.append("g");r.attr("class","component").attr("id",`component_${e}`);let n=0,o=0;if(a.elements.forEach((t=>{n=O(r,t,n,o,a),o+=1})),a.label){const t=n+(a.lineSpacing||20);let e=50,o="start";switch(a.align||"left"){case"center":o="middle",e=(a.width||200)/2;break;case"right":o="end",e=(a.width||200)-50;break;default:o="start",e=50}r.append("text").attr("x",e).attr("y",t).attr("fill",a.color||"black").attr("font-size",a.fontSize||16).attr("font-weight",a.fontWeight||"normal").attr("font-family",a.fontFamily||"sans-serif").attr("dominant-baseline","hanging").attr("text-anchor",o).attr("class","textDiagramLabel").text(a.label)}}),"drawTextDiagram"),O=(0,d.K2)(((t,a,e,r,n)=>{const o=t.append("g").attr("class","unit").attr("id",`unit_${r}`);let l,i={};"string"==typeof a?l=a:(l=a.value,i=a);const s=i.fontSize||n?.fontSize||20,d=i.color||n?.color||"black",c=i.fontWeight||n?.fontWeight||"normal",p=i.fontFamily||n?.fontFamily||"sans-serif",m=i.align||n?.align||"left",h=n?.lineSpacing||20;let x,g=50;switch(m){case"center":x="middle",g=(n?.width||200)/2;break;case"right":x="end",g=(n?.width||200)-50;break;default:x="start",g=50}const f=l.split("\n");return f.forEach(((t,a)=>{const r=e+a*h;o.append("text").attr("x",g).attr("y",r).attr("fill",d).attr("font-size",s).attr("font-weight",c).attr("font-family",p).attr("dominant-baseline","hanging").attr("text-anchor",x).attr("class","textElement").text(v(t))})),e+f.length*h}),"drawElement"),Q=(0,d.K2)((t=>{const a=[],e=new Set;return t.forEach(((t,r)=>{if(e.has(r))return;if("text"===t.type&&t.position&&"object"==typeof t.position&&"type"in t.position&&"previous"===t.position.type){const n=a[a.length-1];return void(n&&(n.textItems.push({item:{...t,index:r},placement:t.position.placement||t.placement||"below"}),e.add(r)))}const n={type:t.type,position:t.position&&("column"in t.position||"col"in t.position)?t.position:void 0,mainItem:{...t,index:r},textItems:[]};a.push(n),e.add(r)})),a}),"processItemsWithRelativePositioning"),Z={parser:y,db:w,renderer:{draw:(0,d.K2)(((t,a,e,r)=>{const n=r.db,o=n.getConfig(),i=n.getPages(),c=n.getDiagramTitle(),p=n.getSize&&n.getSize(),m=p?.width||1e3,h=p?.height||800,x=(0,l.D)(a),g=(0,d.K2)(((t,a,e)=>{const r=t.append("g").attr("id",`page${e}`).attr("class","page").attr("display",0===e?"inline":"none");c&&r.append("text").text(c).attr("x",m/2).attr("y",25).attr("dominant-baseline","middle").attr("text-anchor","middle").attr("class","pageTitle");const n=a.layout||{columns:1,rows:1},l=c?50:20,i=m-40,s=h-l-20,d=Q(a.subDiagrams),p=[],x=[];d.forEach((t=>{if(t.position){const{column:a,row:e}=t.position,r="object"==typeof a?a.start:a,o="object"==typeof a?a.end:a,l="object"==typeof e?e.start:e,i="object"==typeof e?e.end:e;l>=0&&i<n.rows&&r>=0&&o<n.columns&&l<=i&&r<=o?p.push({item:t,position:{colStart:r,colEnd:o,rowStart:l,rowEnd:i}}):x.push(t)}else x.push(t)}));let g=0;p.forEach((({position:t})=>{g+=(t.colEnd-t.colStart+1)*(t.rowEnd-t.rowStart+1)}));const f=n.columns*n.rows-g,w=x.length;if(w>f){const t=g+w;let a=n.columns,e=n.rows;const r=3;for(;a*e<t;){const t=a/e;t>r?e++:t<1/r||a<=e?a++:e++}n.columns=a,n.rows=e}const u=i/n.columns,y=s/n.rows,k=[];for(let t=0;t<n.rows;t++){k[t]=[];for(let a=0;a<n.columns;a++)k[t][a]={x:20+a*u,y:l+t*y,occupied:!1}}p.forEach((({position:t})=>{for(let a=t.rowStart;a<=t.rowEnd;a++)for(let e=t.colStart;e<=t.colEnd;e++)k[a]&&k[a][e]&&(k[a][e].occupied=!0)})),p.forEach((({item:t,position:a})=>{const e=k[a.rowStart][a.colStart],n=(a.colEnd-a.colStart+1)*u,l=(a.rowEnd-a.rowStart+1)*y;b(r,t,e.x,e.y,n,l,o)}));let F=0,L=0;x.forEach((t=>{for(;F<n.rows&&k[F][L].occupied;)L++,L>=n.columns&&(L=0,F++);const a=k[F][L];b(r,t,a.x,a.y,u,y,o),k[F][L].occupied=!0,L++,L>=n.columns&&(L=0,F++)}))}),"drawPage"),f=(0,d.K2)(((t,a,e)=>{switch(a.type){case"array":z(t,a,e,a.index);break;case"matrix":$(t,a,e,a.index);break;case"stack":C(t,a,a.index);break;case"graph":M(t,a,a.index);break;case"tree":X(t,a,a.index);break;case"linkedList":R(t,a,a.index);break;case"text":J(t,a,a.index);break;default:throw new Error(`Unknown diagram type: ${a.type}`)}}),"drawSingleDiagram"),b=(0,d.K2)(((t,a,e,r,n,o,l)=>{if(0===a.textItems.length)return void w(t,a.mainItem,e,r,n,o,l);const i=t.append("g").attr("class",`container-${a.type}`).attr("id",`container-${a.mainItem.index}`),s=i.append("g").attr("class","temp-main").style("visibility","hidden");f(s,a.mainItem,l);const d=s.node().getBBox();s.remove();const c=[];a.textItems.forEach((({item:t,placement:a})=>{const e=i.append("g").attr("class","temp-text").style("visibility","hidden");f(e,t,l);const r=e.node().getBBox();e.remove(),c.push({bbox:r,placement:a,item:t})}));let p=d.width,m=d.height,h=0,x=0,g=0,b=0;c.forEach((({bbox:t,placement:a})=>{switch(a){case"left":h=Math.max(h,t.width+10);break;case"right":x=Math.max(x,t.width+10);break;case"above":g=Math.max(g,t.height+10);break;case"below":b=Math.max(b,t.height+10)}})),p+=h+x,m+=g+b;const u=(n-20)/p,y=(o-20)/m,k=Math.min(1,u,y),F=e+n/2-p*k/2,L=r+o/2-m*k/2;i.attr("transform",`translate(${F}, ${L}) scale(${k})`);const v=h-d.x,E=g-d.y,z=i.append("g").attr("class",`main-${a.type}`).attr("transform",`translate(${v}, ${E})`);f(z,a.mainItem,l),c.forEach((({bbox:t,placement:a,item:e})=>{const r=i.append("g").attr("class","text-item");let n=0,o=0;const s=h,c=g;switch(a){case"left":n=s-t.width-10,o=c+d.height/2-t.height/2;break;case"right":n=s+d.width+10,o=c+d.height/2-t.height/2;break;case"above":n=s+d.width/2-t.width/2,o=c-t.height-10;break;case"below":n=s+d.width/2-t.width/2,o=c+d.height+10}n-=t.x,o-=t.y,r.attr("transform",`translate(${n}, ${o})`),f(r,e,l)}))}),"drawGroupAtPosition"),w=(0,d.K2)(((t,a,e,r,n,o,l)=>{const i=t.append("g").attr("class","temp-measure").style("visibility","hidden");f(i,a,l);const s=i.node().getBBox(),d=s.width,c=s.height,p=s.x,m=s.y,h=(n-20)/d,x=(o-20)/c,g=Math.min(1,h,x),b=e+n/2-(p+d/2)*g,w=r+o/2-(m+c/2)*g;i.remove();const u=t.append("g").attr("class",`viewport-${a.type}`).attr("id",`viewport-${a.index}`);u.attr("transform",`translate(${b}, ${w}) scale(${g})`),f(u,a,l)}),"drawDiagramAtPosition");x.attr("viewBox",`0 0 ${m} ${h}`),(0,s.a$)(x,h,m,o.useMaxWidth),i.forEach(((t,a)=>{g(x,t,a)}))}),"draw")},styles:(0,d.K2)(((t={})=>(s.Rm.debug({options:t}),`\n    .element {\n      font-size: ${t.array?.elementFontSize??"10px"};\n      fill: ${t.array?.valueColor??"black"};\n    }\n    .element.index {\n      fill: ${t.array?.indexColor??"black"};\n    }\n    .element {\n      stroke: ${t.array?.elementStrokeColor??"black"};\n      stroke-width: ${t.array?.elementStrokeWidth??"1"};\n      fill: ${t.array?.elementFillColor??"#efefef"};\n    }\n  `)),"styles")}}}]);